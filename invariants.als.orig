/******************
 * INVARIANTS
 ******************/

open signatures
open constraints
open functions

/**
 * TODO:
 * - Think about what are the conditions that need to get satisfied for every action
 */

pred Invariants[s : Nicebook] {
	objectConstraints
	stateInvariants[s]
}

pred stateInvariants[s : Nicebook] {
    invariantUserCanOnlyBeFriendsWithUsersInTheSameState[s]
	invariantContentCanHaveOneOwnerInOneState[s]
	invariantUsersCanBeTaggedByFriendsOnly[s]
}

<<<<<<< HEAD
-- Users cannot be friends with users in another Nicebook
||||||| b51a46f
=======
-- A user cannot be friends with a user who is not in the same stae
>>>>>>> stable
pred invariantUserCanOnlyBeFriendsWithUsersInTheSameState[s: Nicebook] {
	s.users.friends in s.users
}

<<<<<<< HEAD
-- Content can be owned by only one user in a Nicebook
||||||| b51a46f
=======
-- It is okay for Content to have two owners in different states
>>>>>>> stable
pred invariantContentCanHaveOneOwnerInOneState[s : Nicebook] {
	all c : s.users.owns | one (s.users & owns.c)
}
<<<<<<< HEAD

||||||| b51a46f
=======

-- Users can only be tagged by their friends
pred invariantUsersCanBeTaggedByFriendsOnly[s : Nicebook] {
	all t : getTagsInState[s] | hasTagged.t in isTagged.t.friends
}
>>>>>>> stable
